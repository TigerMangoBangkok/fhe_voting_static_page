(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5766:function(e,s,t){Promise.resolve().then(t.bind(t,8892))},8892:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return T}});var a=t(7437),l=t(2265),r=t(457),i=t(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,i.Z)("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),c=(0,i.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),o=(0,i.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function d(){let{isConnected:e,isConnecting:s,isCorrectNetwork:t,connectWallet:l,disconnectWallet:i,switchToSepolia:d,networkName:x}=(0,r.useWeb3)();return s?(0,a.jsx)("button",{disabled:!0,className:"btn-primary opacity-50 cursor-not-allowed",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,a.jsx)("span",{children:"Connecting..."})]})}):e?t?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 bg-green-100 text-green-800 rounded-lg",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.jsx)("span",{className:"text-sm",children:x})]}),(0,a.jsx)("button",{onClick:i,className:"btn-secondary text-sm",children:(0,a.jsx)(o,{className:"h-4 w-4"})})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 bg-yellow-100 text-yellow-800 rounded-lg",children:[(0,a.jsx)(c,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:"Wrong Network"})]}),(0,a.jsx)("button",{onClick:d,className:"btn-secondary text-sm",children:"Switch to Sepolia"}),(0,a.jsx)("button",{onClick:i,className:"btn-danger text-sm",children:(0,a.jsx)(o,{className:"h-4 w-4"})})]}):(0,a.jsx)("button",{onClick:l,className:"btn-primary",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(n,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Connect Wallet"})]})})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,i.Z)("Vote",[["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}],["path",{d:"M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z",key:"1ezoue"}],["path",{d:"M22 19H2",key:"nuriw5"}]]),m=(0,i.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),h=(0,i.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),u=(0,i.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var p=t(3008),y=t(2104);function j(e){let s=e-Math.floor(Date.now()/1e3);if(s<=0)return"Ended";let t=Math.floor(s/86400),a=Math.floor(s%86400/3600),l=Math.floor(s%3600/60);return t>0?"".concat(t,"d ").concat(a,"h ").concat(l,"m"):a>0?"".concat(a,"h ").concat(l,"m"):l>0?"".concat(l,"m"):"Less than 1m"}function g(e){return new Date(1e3*e).toLocaleString()}function b(e,s,t){return t?{status:"Results Public",color:"badge-info"}:Math.floor(Date.now()/1e3)>s?{status:"Voting Ended",color:"badge-warning"}:!function(e,s){let t=Math.floor(Date.now()/1e3);return t>=e&&t<=s}(e,s)?{status:"Not Started",color:"badge-secondary"}:{status:"Active",color:"badge-success"}}var v=t(4804);function N(){let{proposals:e,isLoading:s,vote:t,fheStatus:i,hasUserVoted:n,account:c}=(0,r.useWeb3)(),[o,d]=(0,l.useState)(null),[N,f]=(0,l.useState)(null),[w,k]=(0,l.useState)(new Map);(0,l.useEffect)(()=>{(async()=>{if(!c||0===e.length)return;let s=new Map;for(let t of e)try{let e=await n(t.id);s.set(t.id,e)}catch(e){console.error("Error checking vote status for proposal ".concat(t.id,":"),e),s.set(t.id,!1)}k(s)})()},[c,e,n]);let C=async(e,s)=>{if(!i.initialized){(0,v.showToast)("warning","FHE Service","FHE service not yet initialized. Please wait a moment and try again.");return}try{d(e),f(s),await t(e,s),(0,v.showToast)("success","Vote Submitted!","Your ".concat(s?"Yes":"No"," vote has been submitted successfully.")),k(s=>new Map(s.set(e,!0)))}catch(e){console.error("Voting error:",e),(0,v.showToast)("error","Voting Failed",e instanceof Error?e.message:"Unknown error occurred")}finally{d(null),f(null)}};return((0,l.useEffect)(()=>{},[]),s)?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No proposals yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Be the first to create a proposal!"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Active Proposals"})}),!i.initialized&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m,{className:"h-5 w-5 text-yellow-600"}),(0,a.jsx)("span",{className:"text-yellow-800",children:"FHE service is initializing. Please wait before voting."})]})}),(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>{let s=b(e.startTime,e.endTime,e.isPublic),t=o===e.id,l=t&&!0===N,r=t&&!1===N,n=w.get(e.id)||!1;return(0,a.jsxs)("div",{className:"card hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 break-words",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed break-words whitespace-pre-wrap",children:e.description})]}),(0,a.jsx)("span",{className:"badge ".concat(s.color," ml-3 flex-shrink-0"),children:s.status})]}),(0,a.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,a.jsx)("div",{className:"flex items-center text-sm text-gray-600",children:(0,a.jsxs)("span",{className:"truncate",children:["Proposed by ",e.proposer]})}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,a.jsxs)("span",{children:["Ends in ",j(e.endTime)]})]}),(0,a.jsx)("div",{className:"flex items-center text-sm text-gray-600",children:(0,a.jsxs)("span",{children:[e.totalVotes||0," total votes"]})}),c&&n&&(0,a.jsxs)("div",{className:"flex items-center text-sm text-green-600 bg-green-50 px-2 py-1 rounded",children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"You have voted on this proposal"})]})]}),e.isPublic&&void 0!==e.yesCount&&void 0!==e.noCount?(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)("span",{className:"text-green-700",children:["Yes: ",e.yesCount]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 text-red-600"}),(0,a.jsxs)("span",{className:"text-red-700",children:["No: ",e.noCount]})]})]})}):(0,a.jsx)("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-blue-700",children:[(0,a.jsx)(m,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Vote counts are encrypted"})]})}),!e.isPublic&&e.isActive&&!n&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:()=>C(e.id,!0),disabled:t||!i.initialized,className:"w-full py-2 px-4 rounded-lg border-2 transition-colors ".concat(l?"border-green-500 bg-green-50 text-green-700":"border-green-200 hover:border-green-300 text-green-700 hover:bg-green-50"," ").concat(i.initialized?"":"opacity-50 cursor-not-allowed"),children:l?"Voting Yes...":"Vote Yes"}),(0,a.jsx)("button",{onClick:()=>C(e.id,!1),disabled:t||!i.initialized,className:"w-full py-2 px-4 rounded-lg border-2 transition-colors ".concat(r?"border-red-500 bg-red-50 text-red-700":"border-red-200 hover:border-red-300 text-red-700 hover:bg-red-50"," ").concat(i.initialized?"":"opacity-50 cursor-not-allowed"),children:r?"Voting No...":"Vote No"})]}),!e.isPublic&&e.isActive&&n&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-center text-sm text-green-700",children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"You have already voted on this proposal"})]})}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-4 pt-4 border-t border-gray-100",children:[(0,a.jsxs)("div",{children:["Created: ",g(e.startTime)]}),(0,a.jsxs)("div",{children:["Ends: ",g(e.endTime)]})]})]},e.id)})})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,i.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var w=t(1981);function k(){let{createProposal:e,isLoading:s}=(0,r.useWeb3)(),[t,i]=(0,l.useState)(""),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(1),[x,m]=(0,l.useState)(!1),u=async s=>{if(s.preventDefault(),!t.trim()||!n.trim()){(0,v.showToast)("error","Validation Error","Please fill in all fields");return}try{m(!0),await e(t.trim(),n.trim(),86400*o),i(""),c(""),d(1),(0,v.showToast)("success","Proposal Created!","Your proposal has been created successfully and voting is now open.")}catch(e){console.error("Failed to create proposal:",e),(0,v.showToast)("error","Creation Failed",e instanceof Error?e.message:"Unknown error occurred")}finally{m(!1)}};return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:(0,a.jsx)(f,{className:"h-8 w-8 text-blue-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Proposal"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Create a new voting proposal that users can vote on using encrypted ballots"})]}),(0,a.jsxs)("form",{onSubmit:u,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Proposal Title *"}),(0,a.jsx)("input",{type:"text",id:"title",value:t,onChange:e=>i(e.target.value),placeholder:"Enter a clear, concise title for your proposal",className:"input-field",required:!0,maxLength:100}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[t.length,"/100 characters"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Proposal Description *"}),(0,a.jsx)("textarea",{id:"description",value:n,onChange:e=>c(e.target.value),placeholder:"Provide a detailed description of what this proposal is about and what voters should consider",rows:6,className:"input-field resize-none",required:!0,maxLength:1e3}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[n.length,"/1000 characters"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700 mb-2",children:"Voting Duration *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{id:"duration",value:o,onChange:e=>d(Number(e.target.value)),className:"input-field appearance-none pr-10",required:!0,children:[{value:1,label:"1 day"},{value:3,label:"3 days"},{value:7,label:"1 week"},{value:14,label:"2 weeks"},{value:30,label:"1 month"}].map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,a.jsx)(h,{className:"h-4 w-4 text-gray-400"})})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Choose how long the voting period should last (maximum 30 days)"})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,a.jsx)("h4",{className:"font-medium mb-1",children:"How it works:"}),(0,a.jsxs)("ul",{className:"space-y-1",children:[(0,a.jsx)("li",{children:"• Your proposal will be created immediately and voting will begin"}),(0,a.jsx)("li",{children:"• All votes are encrypted using FHE (Fully Homomorphic Encryption)"}),(0,a.jsx)("li",{children:"• Vote counts remain private until you make them public"}),(0,a.jsx)("li",{children:"• Only you can reveal the results after the voting period ends"}),(0,a.jsx)("li",{children:"• Maximum voting duration is 30 days"})]})]})]})}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{type:"submit",disabled:x||s,className:"btn-primary min-w-[120px]",children:x?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,a.jsx)("span",{children:"Creating..."})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Create Proposal"})]})})})]})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let C=(0,i.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function E(){let{account:e,proposals:s,isLoading:t,makeVoteCountsPublic:i,fheStatus:n}=(0,r.useWeb3)(),[c,o]=(0,l.useState)(null),d=async e=>{try{o(e),await i(e),(0,v.showToast)("success","Results Revealed!","Vote counts have been made public successfully.")}catch(e){console.error("Failed to reveal results:",e),(0,v.showToast)("error","Reveal Failed",e instanceof Error?e.message:"Unknown error occurred")}finally{o(null)}};if(!e)return(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(C,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connect your wallet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Connect your wallet to view your proposals"})]});if(t)return(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading your proposals..."})]});let x=s.filter(s=>{var t;return(null===(t=s.proposer)||void 0===t?void 0:t.toLowerCase())===e.toLowerCase()});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"My Proposals"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage and monitor the proposals you've created"})]})}),0===x.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,a.jsx)(C,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No proposals created yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Create your first proposal to get started"})]}):(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:x.map(e=>{let s=b(e.startTime,e.endTime,e.isPublic),t=!e.isPublic&&e.endTime<Math.floor(Date.now()/1e3);return(0,a.jsxs)("div",{className:"card hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 break-words",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed break-words whitespace-pre-wrap",children:e.description})]}),(0,a.jsx)("span",{className:"badge ".concat(s.color," ml-3 flex-shrink-0"),children:s.status})]}),(0,a.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,a.jsxs)("span",{children:["Ends in ",j(e.endTime)]})]}),(0,a.jsx)("div",{className:"flex items-center text-sm text-gray-600",children:(0,a.jsxs)("span",{children:[e.totalVotes||0," total votes"]})})]}),e.isPublic&&void 0!==e.yesCount&&void 0!==e.noCount?(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)("span",{className:"text-green-700",children:["Yes: ",e.yesCount]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 text-red-600"}),(0,a.jsxs)("span",{className:"text-red-700",children:["No: ",e.noCount]})]})]})}):(0,a.jsx)("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-blue-700",children:[(0,a.jsx)(m,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Vote counts are encrypted"})]})}),t&&(0,a.jsx)("button",{onClick:()=>d(e.id),disabled:c===e.id,className:"btn-primary w-full",children:c===e.id?"Revealing...":"Reveal Results"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-4 pt-4 border-t border-gray-100",children:[(0,a.jsxs)("div",{children:["Created: ",g(e.startTime)]}),(0,a.jsxs)("div",{children:["Ends: ",g(e.endTime)]})]})]},e.id)})}),!n.initialized&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m,{className:"h-5 w-5 text-yellow-600"}),(0,a.jsx)("span",{className:"text-yellow-800",children:"FHE service is initializing. Some features may be limited."})]})})]})}function M(){let{account:e,proposals:s,isLoading:t,fheStatus:i,hasUserVoted:n,getMyVote:c,fheUserDecrypt:o}=(0,r.useWeb3)(),[d,u]=(0,l.useState)(null),[p,y]=(0,l.useState)([]),[N,f]=(0,l.useState)(new Map);(0,l.useEffect)(()=>{(async()=>{if(!e||0===s.length)return;let t=[];for(let e of s)try{await n(e.id)&&t.push(e)}catch(s){console.error("Error checking if user voted on proposal ".concat(e.id,":"),s)}y(t)})()},[e,s,n]);let w=async e=>{if(!i.initialized){(0,v.showToast)("warning","FHE Service","FHE service not yet initialized. Please wait a moment and try again.");return}if(!o){(0,v.showToast)("error","FHE Service","Vote decryption service not available.");return}try{u(e);let s=await c(e);if(!s){(0,v.showToast)("error","No Vote Found","You have not voted on this proposal yet.");return}let t=await o(s),a=0===t?"Yes":"No";(0,v.showToast)("success","Vote Decrypted!","Your vote on this proposal was: ".concat(a)),f(s=>new Map(s.set(e,a)))}catch(e){console.error("Failed to decrypt vote:",e),(0,v.showToast)("error","Decryption Failed",e instanceof Error?e.message:"Unknown error occurred")}finally{u(null)}};return e?t?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading your voting history..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"My Votes"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"View and manage your voting participation"})]})}),0===p.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,a.jsx)(x,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No votes cast yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Participate in proposals to see your voting history"})]}):(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:p.map(e=>{let s=b(e.startTime,e.endTime,e.isPublic),t=N.has(e.id),l=N.get(e.id);return(0,a.jsxs)("div",{className:"card hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 break-words",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed break-words whitespace-pre-wrap",children:e.description})]}),(0,a.jsx)("span",{className:"badge ".concat(s.color," ml-3 flex-shrink-0"),children:s.status})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(C,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,a.jsxs)("span",{className:"truncate",children:["Proposed by ",e.proposer]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,a.jsxs)("span",{children:["Ends in ",j(e.endTime)]})]})]}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"My Vote:"}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:t?(0,a.jsx)("span",{className:"text-sm font-medium ".concat("Yes"===l?"text-green-600":"text-red-600"),children:l}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"text-gray-600 text-sm",children:"Encrypted"})]})})]})}),!t&&i.initialized&&(0,a.jsx)("button",{onClick:()=>w(e.id),disabled:d===e.id,className:"btn-secondary w-full",children:d===e.id?"Decrypting...":"Decrypt My Vote"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-3 pt-3 border-t border-gray-100",children:[(0,a.jsxs)("div",{children:["Voted on: ",g(e.startTime)]}),(0,a.jsxs)("div",{children:["Ends: ",g(e.endTime)]})]})]},e.id)})}),!i.initialized&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m,{className:"h-5 w-5 text-yellow-600"}),(0,a.jsx)("span",{className:"text-yellow-800",children:"FHE service is initializing. Some features may be limited."})]})})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connect your wallet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Connect your wallet to view your voting history"})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let V=(0,i.Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),P=(0,i.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);function T(){let{isConnected:e,account:s}=(0,r.useWeb3)(),[t,i]=(0,l.useState)("proposals"),n=[{id:"proposals",label:"Proposals",icon:x},{id:"create",label:"Create Proposal",icon:f},{id:"myProposals",label:"My Proposals",icon:C},{id:"myVotes",label:"My Votes",icon:V}];return e?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(P,{className:"h-8 w-8 text-blue-600"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"FHE Voting System"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Connected: ",null==s?void 0:s.slice(0,6),"...",null==s?void 0:s.slice(-4)]}),(0,a.jsx)(d,{})]})]})})}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"flex space-x-1 bg-white p-1 rounded-lg shadow-sm mb-8 overflow-x-auto",children:n.map(e=>{let s=e.icon;return(0,a.jsxs)("button",{onClick:()=>i(e.id),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors whitespace-nowrap ".concat(t===e.id?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[(0,a.jsx)(s,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.label})]},e.id)})}),(0,a.jsxs)("div",{className:"space-y-8",children:["proposals"===t&&(0,a.jsx)(N,{}),"create"===t&&(0,a.jsx)(k,{}),"myProposals"===t&&(0,a.jsx)(E,{}),"myVotes"===t&&(0,a.jsx)(M,{})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"FHE Voting System"}),(0,a.jsx)("p",{className:"text-xl text-gray-600 mb-8",children:"Decentralized Confidential Voting using Fully Homomorphic Encryption"}),(0,a.jsx)("div",{className:"max-w-md mx-auto",children:(0,a.jsx)(d,{})})]})})})}}},function(e){e.O(0,[945,14,971,938,744],function(){return e(e.s=5766)}),_N_E=e.O()}]);